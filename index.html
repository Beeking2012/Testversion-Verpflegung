<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feldk√ºche - Milit√§rische Verpflegung</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Kopfleiste -->
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="nav-title">Feldk√ºche</h1>
            <div class="nav-links">
                <a href="#rezepte" class="nav-link active" data-page="rezepte">Rezepte</a>
                <a href="#einkaufsliste" class="nav-link" data-page="einkaufsliste">Einkaufsliste</a>
            </div>
        </div>
    </nav>

    <main class="content">
        <!-- Rezept-Seite -->
        <div id="rezepte" class="page active">
            <div class="container">
                <h2>Rezeptauswahl</h2>
                
                <!-- Filter-Optionen -->
                <div class="filter-section">
                    <div class="filter-group">
                        <label>Verpflegungsart:</label>
                        <select id="verpflegungsart">
                            <option value="">Alle</option>
                            <option value="warm">Warmverpflegung</option>
                            <option value="kalt">Kaltverpflegung</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>Verpflegungstyp:</label>
                        <select id="verpflegungstyp">
                            <option value="">Alle</option>
                            <option value="voll">Vollverpflegung</option>
                            <option value="hand">Handverpflegation</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>
                            <input type="checkbox" id="vegetarisch" checked>
                            Nur vegetarische Rezepte
                        </label>
                    </div>
                </div>

                <!-- Personenanzahl -->
                <div class="personen-input">
                    <label for="personen">Personenanzahl:</label>
                    <input type="number" id="personen" min="1" max="100" value="4">
                </div>

                <!-- Rezept-Auswahl -->
                <div class="rezepte-grid" id="rezepte-liste">
                    <!-- Rezepte werden hier dynamisch eingef√ºgt -->
                </div>

                <!-- Ausgew√§hltes Rezept -->
                <div id="rezept-details" class="rezept-details" style="display: none;">
                    <div class="rezept-header">
                        <h3 id="rezept-titel"></h3>
                        <div class="rezept-meta">
                            <span id="rezept-kalorien"></span>
                            <span id="rezept-zubereitungszeit"></span>
                            <span id="rezept-art"></span>
                        </div>
                    </div>
                    
                    <div class="rezept-content">
                        <div class="zutaten-section">
                            <h4>Zutaten</h4>
                            <ul id="rezept-zutaten"></ul>
                        </div>
                        
                        <div class="zubereitung-section">
                            <h4>Zubereitung</h4>
                            <ol id="rezept-zubereitung"></ol>
                        </div>
                        
                        <div class="portionierung-section">
                            <h4>Portionierung</h4>
                            <p id="rezept-portionierung"></p>
                        </div>
                    </div>
                    
                    <div class="rezept-actions">
                        <button onclick="exportRezeptPDF()">Rezept als PDF exportieren</button>
                        <button onclick="zurEinkaufsliste()">Zur Einkaufsliste</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Einkaufsliste-Seite -->
        <div id="einkaufsliste" class="page">
            <div class="container">
                <h2>Einkaufsliste</h2>
                
                <div class="einkaufsliste-info">
                    <p>F√ºr <span id="einkauf-personen">4</span> Personen</p>
                    <div>
                        <button onclick="exportEinkaufslistePDF()">Einkaufsliste als PDF exportieren</button>
                        <button onclick="showPage('rezepte')">Zur√ºck zu Rezepten</button>
                    </div>
                </div>
                
                <div id="einkaufsliste-content">
                    <!-- Einkaufsliste wird hier dynamisch eingef√ºgt -->
                </div>
            </div>
        </div>
    </main>

    <script>
        // Rezepte Daten direkt in der HTML Datei
        const rezepteDaten = [
            {
                id: 1,
                titel: "Feldk√ºchen-Eintopf",
                beschreibung: "Herzhafter Eintopf mit Gem√ºse und Tofu",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: true,
                kalorien: 450,
                zubereitungszeit: 45,
                zutaten: [
                    { menge: 500, einheit: "g", name: "Tofu, gew√ºrfelt" },
                    { menge: 4, einheit: "", name: "Kartoffeln, gew√ºrfelt" },
                    { menge: 2, einheit: "", name: "Karotten, in Scheiben" },
                    { menge: 1, einheit: "", name: "Zwiebel, gew√ºrfelt" },
                    { menge: 2, einheit: "EL", name: "Tomatenmark" },
                    { menge: 1.5, einheit: "l", name: "Gem√ºsebr√ºhe" },
                    { menge: 2, einheit: "TL", name: "Paprikapulver" },
                    { menge: 1, einheit: "Bund", name: "Petersilie, gehackt" }
                ],
                zubereitung: [
                    "Zwiebel in einem gro√üen Topf anschwitzen",
                    "Tomatenmark zugeben und kurz mitr√∂sten",
                    "Kartoffeln und Karotten hinzuf√ºgen, 5 Minuten mitd√ºnsten",
                    "Mit Gem√ºsebr√ºhe abl√∂schen und aufkochen lassen",
                    "Bei mittlerer Hitze 20 Minuten k√∂cheln lassen",
                    "Tofu und Gew√ºrze zugeben, weitere 10 Minuten k√∂cheln",
                    "Mit Petersilie bestreuen und servieren"
                ],
                portionierung: "In feste Sch√ºsseln portionieren. Pro Person 1,5 Liter Eintopf berechnen. Mit Brot servieren."
            },
            {
                id: 2,
                titel: "Milit√§rischer Nudelauflauf",
                beschreibung: "N√§hrhafter Auflauf mit K√§se und Gem√ºse",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: true,
                kalorien: 520,
                zubereitungszeit: 35,
                zutaten: [
                    { menge: 400, einheit: "g", name: "Nudeln" },
                    { menge: 200, einheit: "g", name: "Gouda, gerieben" },
                    { menge: 1, einheit: "", name: "Brokkoli, in R√∂schen" },
                    { menge: 1, einheit: "", name: "Paprika, gew√ºrfelt" },
                    { menge: 2, einheit: "", name: "Eier" },
                    { menge: 200, einheit: "ml", name: "Sahne" },
                    { menge: 1, einheit: "TL", name: "Muskatnuss" },
                    { menge: 100, einheit: "g", name: "Parmesan, gerieben" }
                ],
                zubereitung: [
                    "Nudeln al dente kochen, Brokkoli blanchieren",
                    "Ofen auf 200¬∞C vorheizen",
                    "Eier mit Sahne und Gew√ºrzen verquirlen",
                    "Nudeln, Gem√ºse und Gouda in eine Auflaufform geben",
                    "Eiermischung dar√ºber gie√üen",
                    "Mit Parmesan bestreuen",
                    "25 Minuten backen bis goldbraun"
                ],
                portionierung: "In Auflaufformen portionieren. Pro Person 1/8 der Form. Mit Salat servieren."
            },
            {
                id: 3,
                titel: "Feld-Sandwiches",
                beschreibung: "Praktische Handverpflegung mit Gem√ºse",
                verpflegungsart: "kalt",
                verpflegungstyp: "hand",
                vegetarisch: true,
                kalorien: 380,
                zubereitungszeit: 15,
                zutaten: [
                    { menge: 8, einheit: "Scheiben", name: "Vollkornbrot" },
                    { menge: 200, einheit: "g", name: "Frischk√§se" },
                    { menge: 1, einheit: "", name: "Gurke, in Scheiben" },
                    { menge: 1, einheit: "", name: "Tomate, in Scheiben" },
                    { menge: 4, einheit: "Bl√§tter", name: "Salat" },
                    { menge: 1, einheit: "", name: "Avocado" },
                    { menge: 2, einheit: "EL", name: "Zitronensaft" }
                ],
                zubereitung: [
                    "Brot scheibenweise mit Frischk√§se bestreichen",
                    "Avocado mit Zitronensaft zerdr√ºcken",
                    "Auf 4 Brotscheiben Salatbl√§tter legen",
                    "Gurken- und Tomatenscheiben darauf anordnen",
                    "Avocadocreme gleichm√§√üig verteilen",
                    "Mit restlichen Brotscheiben bedecken",
                    "Sandwiches diagonal durchschneiden"
                ],
                portionierung: "Jedes Sandwich in Frischhaltefolie wickeln. Pro Person 1 Sandwich (2 Dreiecke)."
            },
            {
                id: 4,
                titel: "Energie-M√ºsli",
                beschreibung: "Kaltes M√ºsli mit N√ºssen und Trockenfr√ºchten",
                verpflegungsart: "kalt",
                verpflegungstyp: "hand",
                vegetarisch: true,
                kalorien: 420,
                zubereitungszeit: 10,
                zutaten: [
                    { menge: 400, einheit: "g", name: "Haferflocken" },
                    { menge: 100, einheit: "g", name: "N√ºsse, gemischt" },
                    { menge: 100, einheit: "g", name: "Trockenfr√ºchte" },
                    { menge: 4, einheit: "EL", name: "Honig" },
                    { menge: 2, einheit: "TL", name: "Zimt" },
                    { menge: 1, einheit: "l", name: "Milch oder Pflanzenmilch" }
                ],
                zubereitung: [
                    "Haferflocken in eine gro√üe Sch√ºssel geben",
                    "N√ºsse hacken und zu den Haferflocken geben",
                    "Trockenfr√ºchte klein schneiden und untermischen",
                    "Honig und Zimt unterr√ºhren",
                    "Alles gut vermengen"
                ],
                portionierung: "In wiederverschlie√übare Beutel portionieren. Pro Person 150g M√ºsli mit 250ml Milch."
            },
            {
                id: 5,
                titel: "Gulasch mit Fleisch",
                beschreibung: "Klassisches Gulasch nach Feldk√ºchenart",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: false,
                kalorien: 580,
                zubereitungszeit: 90,
                zutaten: [
                    { menge: 800, einheit: "g", name: "Rindergulasch" },
                    { menge: 3, einheit: "", name: "Zwiebeln, gew√ºrfelt" },
                    { menge: 2, einheit: "", name: "Paprika, in Streifen" },
                    { menge: 3, einheit: "EL", name: "Tomatenmark" },
                    { menge: 2, einheit: "l", name: "Rinderbr√ºhe" },
                    { menge: 2, einheit: "EL", name: "Paprikapulver" },
                    { menge: 1, einheit: "EL", name: "Majoran" }
                ],
                zubereitung: [
                    "Fleisch in einem gro√üen Topf scharf anbraten",
                    "Zwiebeln zugeben und mitbraten",
                    "Tomatenmark einr√ºhren und kurz r√∂sten",
                    "Mit Br√ºhe abl√∂schen, aufkochen lassen",
                    "Bei kleiner Hitze 60 Minuten k√∂cheln",
                    "Paprika zugeben, weitere 20 Minuten garen",
                    "Mit Gew√ºrzen abschmecken"
                ],
                portionierung: "Mit Kartoffeln oder Nudeln servieren. Pro Person 300g Gulasch mit Beilage."
            }
        ];
    </script>

    <script>
        // Globale Variablen
        let aktuellesRezept = null;
        let personenAnzahl = 4;

        // Initialisierung
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM geladen - starte Initialisierung');
            
            // Event Listener f√ºr Filter
            document.getElementById('verpflegungsart').addEventListener('change', filterRezepte);
            document.getElementById('verpflegungstyp').addEventListener('change', filterRezepte);
            document.getElementById('vegetarisch').addEventListener('change', filterRezepte);
            document.getElementById('personen').addEventListener('input', function() {
                personenAnzahl = parseInt(this.value) || 1;
                console.log('Personenanzahl ge√§ndert:', personenAnzahl);
                if (aktuellesRezept) {
                    zeigeRezeptDetails(aktuellesRezept);
                }
                aktualisiereEinkaufsliste();
            });

            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');
                    showPage(pageId);
                });
            });

            // Startseite anzeigen
            filterRezepte();
            
            // Browser Navigation behandeln
            window.addEventListener('popstate', function() {
                const hash = window.location.hash.replace('#', '') || 'rezepte';
                showPage(hash);
            });

            const initialPage = window.location.hash.replace('#', '') || 'rezepte';
            showPage(initialPage);
        });

        // Seitenwechsel
        function showPage(pageId) {
            console.log('Wechsle zu Seite:', pageId);
            
            // Navigation aktualisieren
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === pageId) {
                    link.classList.add('active');
                }
            });

            // Seiten anzeigen/verstecken
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            document.getElementById(pageId).classList.add('active');

            // URL aktualisieren
            window.history.pushState(null, null, `#${pageId}`);

            // Einkaufsliste aktualisieren falls n√∂tig
            if (pageId === 'einkaufsliste') {
                aktualisiereEinkaufsliste();
            }
        }

        // Rezepte filtern und anzeigen
        function filterRezepte() {
            console.log('Filtere Rezepte...');
            const verpflegungsart = document.getElementById('verpflegungsart').value;
            const verpflegungstyp = document.getElementById('verpflegungstyp').value;
            const nurVegetarisch = document.getElementById('vegetarisch').checked;

            console.log('Filter:', { verpflegungsart, verpflegungstyp, nurVegetarisch });

            const gefilterteRezepte = rezepteDaten.filter(rezept => {
                if (verpflegungsart && rezept.verpflegungsart !== verpflegungsart) return false;
                if (verpflegungstyp && rezept.verpflegungstyp !== verpflegungstyp) return false;
                if (nurVegetarisch && !rezept.vegetarisch) return false;
                return true;
            });

            console.log('Gefilterte Rezepte:', gefilterteRezepte);
            zeigeRezepte(gefilterteRezepte);
        }

        // Rezepte in der Grid anzeigen
        function zeigeRezepte(rezepte) {
            const container = document.getElementById('rezepte-liste');
            console.log('Zeige Rezepte an:', rezepte.length);
            
            if (rezepte.length === 0) {
                container.innerHTML = '<p class="keine-rezepte">Keine Rezepte gefunden, die den Filterkriterien entsprechen.</p>';
                document.getElementById('rezept-details').style.display = 'none';
                return;
            }

            container.innerHTML = rezepte.map(rezept => `
                <div class="rezept-karte" onclick="zeigeRezeptDetails(${rezept.id})">
                    <h4>${rezept.titel}</h4>
                    <div class="rezept-info">
                        <span>${rezept.verpflegungsart === 'warm' ? 'üî• Warm' : '‚ùÑÔ∏è Kalt'}</span>
                        <span>${rezept.verpflegungstyp === 'voll' ? 'üçΩÔ∏è Voll' : '‚úã Hand'}</span>
                        <span>${rezept.vegetarisch ? 'üå± Vegetarisch' : 'ü•© Mit Fleisch'}</span>
                    </div>
                    <p class="rezept-beschreibung">${rezept.beschreibung}</p>
                    <div class="rezept-info">
                        <span>${rezept.kalorien} kcal/Person</span>
                        <span>${rezept.zubereitungszeit} min</span>
                    </div>
                </div>
            `).join('');

            // Rezept Details ausblenden
            document.getElementById('rezept-details').style.display = 'none';
            aktuellesRezept = null;
        }

        // Rezept Details anzeigen
        function zeigeRezeptDetails(rezeptId) {
            console.log('Zeige Rezept Details:', rezeptId);
            const rezept = rezepteDaten.find(r => r.id === rezeptId);
            aktuellesRezept = rezept;

            if (!rezept) {
                console.error('Rezept nicht gefunden:', rezeptId);
                return;
            }

            // Karten Auswahl aktualisieren
            document.querySelectorAll('.rezept-karte').forEach(karte => {
                karte.classList.remove('ausgewaehlt');
            });
            event.currentTarget.classList.add('ausgewaehlt');

            // Details anzeigen
            document.getElementById('rezept-titel').textContent = rezept.titel;
            document.getElementById('rezept-kalorien').textContent = `${rezept.kalorien * personenAnzahl} kcal gesamt`;
            document.getElementById('rezept-zubereitungszeit').textContent = `${rezept.zubereitungszeit} min Zubereitung`;
            document.getElementById('rezept-art').textContent = `${rezept.verpflegungsart === 'warm' ? 'Warm' : 'Kalt'} ‚Ä¢ ${rezept.verpflegungstyp === 'voll' ? 'Voll' : 'Hand'} ‚Ä¢ ${rezept.vegetarisch ? 'Vegetarisch' : 'Mit Fleisch'}`;

            // Zutaten anzeigen (skaliert)
            const zutatenListe = document.getElementById('rezept-zutaten');
            zutatenListe.innerHTML = rezept.zutaten.map(zutat => {
                const skalierteMenge = (zutat.menge / 4) * personenAnzahl;
                return `<li>${skalierteMenge.toFixed(1)} ${zutat.einheit} ${zutat.name}</li>`;
            }).join('');

            // Zubereitung anzeigen
            const zubereitungListe = document.getElementById('rezept-zubereitung');
            zubereitungListe.innerHTML = rezept.zubereitung.map(schritt => 
                `<li>${schritt}</li>`
            ).join('');

            // Portionierung anzeigen
            document.getElementById('rezept-portionierung').textContent = rezept.portionierung;

            // Details einblenden
            document.getElementById('rezept-details').style.display = 'block';
        }

        // Zur Einkaufsliste navigieren
        function zurEinkaufsliste() {
            if (aktuellesRezept) {
                showPage('einkaufsliste');
            } else {
                alert('Bitte w√§hle zuerst ein Rezept aus!');
            }
        }

        // Einkaufsliste aktualisieren
        function aktualisiereEinkaufsliste() {
            console.log('Aktualisiere Einkaufsliste');
            if (!aktuellesRezept) {
                document.getElementById('einkaufsliste-content').innerHTML = '<p>Bitte w√§hle zuerst ein Rezept aus der Rezept-Seite aus.</p>';
                return;
            }

            document.getElementById('einkauf-personen').textContent = personenAnzahl;
            
            const container = document.getElementById('einkaufsliste-content');
            
            const zutatenGruppiert = gruppiereZutaten(aktuellesRezept.zutaten);
            
            container.innerHTML = Object.keys(zutatenGruppiert).map(kategorie => `
                <div class="einkaufsliste-kategorie">
                    <h3>${kategorie}</h3>
                    ${zutatenGruppiert[kategorie].map(zutat => `
                        <div class="einkaufsliste-item">
                            <span>${zutat.name}</span>
                            <span>${zutat.menge} ${zutat.einheit}</span>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }

        // Zutaten nach Kategorien gruppieren
        function gruppiereZutaten(zutaten) {
            const gruppiert = {
                'Gem√ºse & Obst': [],
                'Proteine': [],
                'Getreide & Beilagen': [],
                'Milchprodukte': [],
                'Gew√ºrze & √ñle': []
            };

            zutaten.forEach(zutat => {
                const skalierteMenge = (zutat.menge / 4) * personenAnzahl;
                const zutatMitMenge = {
                    ...zutat,
                    menge: skalierteMenge.toFixed(1)
                };

                // Einfache Kategorisierung basierend auf Zutatenname
                const name = zutat.name.toLowerCase();
                if (name.includes('kartoffel') || name.includes('karotte') || name.includes('zwiebel') || 
                    name.includes('tomate') || name.includes('gurke') || name.includes('brokkoli') ||
                    name.includes('paprika') || name.includes('avocado') || name.includes('salat')) {
                    gruppiert['Gem√ºse & Obst'].push(zutatMitMenge);
                } else if (name.includes('tofu') || name.includes('fleisch') || name.includes('rinder') || 
                           name.includes('ei') || name.includes('nuss')) {
                    gruppiert['Proteine'].push(zutatMitMenge);
                } else if (name.includes('nudel') || name.includes('brot') || name.includes('hafer')) {
                    gruppiert['Getreide & Beilagen'].push(zutatMitMenge);
                } else if (name.includes('k√§se') || name.includes('sahne') || name.includes('milch') || 
                           name.includes('frischk√§se') || name.includes('parmesan') || name.includes('gouda')) {
                    gruppiert['Milchprodukte'].push(zutatMitMenge);
                } else {
                    gruppiert['Gew√ºrze & √ñle'].push(zutatMitMenge);
                }
            });

            // Leere Kategorien entfernen
            Object.keys(gruppiert).forEach(kategorie => {
                if (gruppiert[kategorie].length === 0) {
                    delete gruppiert[kategorie];
                }
            });

            return gruppiert;
        }

        // PDF Export f√ºr Rezept (vereinfacht - √∂ffnet Druckdialog)
        function exportRezeptPDF() {
            if (!aktuellesRezept) {
                alert('Bitte w√§hle zuerst ein Rezept aus!');
                return;
            }
            window.print();
        }

        // PDF Export f√ºr Einkaufsliste (vereinfacht - √∂ffnet Druckdialog)
        function exportEinkaufslistePDF() {
            if (!aktuellesRezept) {
                alert('Bitte w√§hle zuerst ein Rezept aus!');
                return;
            }
            window.print();
        }
    </script>
</body>
</html>
