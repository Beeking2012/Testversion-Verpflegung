<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feldküche - SEG Verpflegung</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            background-color: #f5f5f5;
            color: #333;
        }

        /* Kopfleiste */
        .navbar {
            background: #2c3e50;
            color: white;
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .nav-title {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .nav-link:hover,
        .nav-link.active {
            background-color: #34495e;
        }

        /* Hauptinhalt */
        .content {
            margin-top: 80px;
            min-height: calc(100vh - 80px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Filter-Sektion */
        .filter-section {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-group label {
            font-weight: bold;
            font-size: 0.9rem;
        }

        select, input[type="number"], input[type="text"] {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .personen-input {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .personen-input label {
            font-weight: bold;
            margin-right: 1rem;
        }

        .personen-input input {
            width: 120px;
        }

        /* Rezepte Grid */
        .rezepte-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .rezept-karte {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            border: 2px solid transparent;
        }

        .rezept-karte:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }

        .rezept-karte.ausgewaehlt {
            border-color: #3498db;
            background-color: #f8f9fa;
        }

        .rezept-karte h4 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .rezept-info {
            display: flex;
            gap: 1rem;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
            flex-wrap: wrap;
        }

        .rezept-beschreibung {
            font-size: 0.9rem;
            color: #555;
            margin-bottom: 0.5rem;
        }

        /* Rezept Details */
        .rezept-details {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .rezept-header {
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }

        .rezept-header h3 {
            color: #2c3e50;
            font-size: 1.8rem;
            margin-bottom: 1rem;
        }

        .rezept-meta {
            display: flex;
            gap: 2rem;
            font-size: 0.9rem;
            color: #7f8c8d;
            flex-wrap: wrap;
        }

        .rezept-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 3rem;
        }

        .zutaten-section h4,
        .zubereitung-section h4,
        .portionierung-section h4 {
            color: #2c3e50;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .zutaten-section h4 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.5rem;
        }

        .zutaten-section ul {
            list-style: none;
            padding: 0;
        }

        .zutaten-section li {
            padding: 0.75rem 0;
            border-bottom: 1px solid #ecf0f1;
            font-size: 1rem;
        }

        .zutaten-section li:last-child {
            border-bottom: none;
        }

        .zubereitung-section ol {
            padding-left: 1.5rem;
        }

        .zubereitung-section li {
            padding: 0.75rem 0;
            margin-bottom: 0.5rem;
            line-height: 1.6;
            border-bottom: 1px solid #f8f9fa;
        }

        .portionierung-section {
            grid-column: 1 / -1;
            background: #e8f4f8;
            padding: 1.5rem;
            border-radius: 6px;
            margin-top: 1rem;
            border-left: 4px solid #3498db;
        }

        .portionierung-section h4 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .portionierung-section p {
            line-height: 1.6;
            margin: 0;
        }

        .rezept-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid #ecf0f1;
        }

        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }

        button:hover {
            background: #2980b9;
        }

        button.secondary {
            background: #95a5a6;
        }

        button.secondary:hover {
            background: #7f8c8d;
        }

        button.success {
            background: #27ae60;
        }

        button.success:hover {
            background: #219a52;
        }

        button.warning {
            background: #e67e22;
        }

        button.warning:hover {
            background: #d35400;
        }

        /* Einkaufsliste */
        .einkaufsliste-info {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .einkaufsliste-info p {
            margin: 0;
            font-size: 1.1rem;
        }

        .einkaufsliste-info p strong {
            color: #2c3e50;
        }

        .einkaufsliste-container {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .einkaufsliste-container h3 {
            color: #2c3e50;
            margin-bottom: 1rem;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 0.5rem;
        }

        .einkaufsliste-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid #ecf0f1;
            align-items: center;
        }

        .einkaufsliste-item:last-child {
            border-bottom: none;
        }

        .einkaufsliste-item span:first-child {
            font-weight: 500;
        }

        .einkaufsliste-item span:last-child {
            color: #3498db;
            font-weight: bold;
        }

        /* Lager-Styles */
        .lager-controls {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .lager-form {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: end;
            flex: 1;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group label {
            font-weight: bold;
            font-size: 0.9rem;
        }

        .lager-table {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .lager-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .lager-table th,
        .lager-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .lager-table th {
            background: #34495e;
            color: white;
            font-weight: 600;
        }

        .lager-table tr:hover {
            background: #f8f9fa;
        }

        .lager-table .low-stock {
            background: #ffeaa7;
        }

        .lager-table .critical-stock {
            background: #fab1a0;
        }

        .lager-actions {
            display: flex;
            gap: 0.5rem;
        }

        .lager-actions button {
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
        }

        .lager-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-card h3 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .stat-card .number {
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
        }

        .stat-card.warning .number {
            color: #e67e22;
        }

        .stat-card.critical .number {
            color: #e74c3c;
        }

        .keine-rezepte {
            text-align: center;
            padding: 2rem;
            background: white;
            border-radius: 8px;
            color: #666;
        }

        /* Seiten werden standardmäßig ausgeblendet */
        .page {
            display: none;
        }

        /* Nur die aktive Seite wird angezeigt */
        .page.active {
            display: block;
        }

        /* DRUCK-STYLES KORRIGIERT */
        @media print {
            /* Alles ausblenden */
            body * {
                visibility: hidden;
            }
            
            /* Nur die Druck-Container anzeigen */
            #druck-rezept-container,
            #druck-einkaufsliste-container,
            #druck-rezept-container *,
            #druck-einkaufsliste-container * {
                visibility: visible !important;
                display: block !important;
            }
            
            /* Druck-Container positionieren */
            #druck-rezept-container,
            #druck-einkaufsliste-container {
                position: absolute !important;
                left: 0 !important;
                top: 0 !important;
                width: 100% !important;
                background: white !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            
            /* Alles andere komplett ausblenden */
            .navbar,
            .rezept-actions,
            .einkaufsliste-info,
            .filter-section,
            .personen-input,
            .rezepte-grid,
            .rezept-details,
            #einkaufsliste-content,
            .container {
                display: none !important;
                visibility: hidden !important;
            }
            
            /* Optimierungen für Druck */
            body {
                background: white !important;
                font-size: 10pt !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            
            h1, h2, h3 {
                color: #000 !important;
                page-break-after: avoid;
            }
            
            table {
                page-break-inside: avoid;
            }
            
            ol, ul {
                page-break-inside: avoid;
            }
        }

        /* Verbesserte Druck-Container */
        .druck-container {
            display: none;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            .filter-section {
                flex-direction: column;
                align-items: stretch;
            }
            
            .rezept-content {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .rezepte-grid {
                grid-template-columns: 1fr;
            }
            
            .einkaufsliste-info {
                flex-direction: column;
                align-items: stretch;
                text-align: center;
            }
            
            .rezept-actions {
                flex-direction: column;
            }
            
            .rezept-meta {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .lager-form {
                flex-direction: column;
                align-items: stretch;
            }
            
            .lager-table {
                overflow-x: auto;
            }
            
            .lager-actions {
                flex-direction: column;
            }
        }
        
        /* Mobile First Optimierungen */
        @media (max-width: 480px) {
            .nav-title {
                font-size: 1.2rem;
            }
            
            .nav-links {
                gap: 1rem;
            }
            
            .nav-link {
                padding: 0.4rem 0.8rem;
                font-size: 0.9rem;
            }
            
            .container {
                padding: 0.5rem;
            }
            
            .rezept-karte {
                padding: 1rem;
            }
            
            .rezept-details {
                padding: 1rem;
            }
            
            .rezept-content {
                gap: 1.5rem;
            }
            
            button {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
            }
            
            .lager-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Kopfleiste -->
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="nav-title">SEG Feldküche</h1>
            <div class="nav-links">
                <a href="#rezepte" class="nav-link active" data-page="rezepte">Rezepte</a>
                <a href="#einkaufsliste" class="nav-link" data-page="einkaufsliste">Einkaufsliste</a>
                <a href="#lager" class="nav-link" data-page="lager">Lager</a>
            </div>
        </div>
    </nav>

    <main class="content">
        <!-- Rezept-Seite -->
        <div id="rezepte" class="page active">
            <div class="container">
                <h2>Rezeptauswahl SEG Verpflegung</h2>
                
                <!-- Filter-Optionen -->
                <div class="filter-section">
                    <div class="filter-group">
                        <label>Verpflegungsart:</label>
                        <select id="verpflegungsart">
                            <option value="">Alle</option>
                            <option value="warm">Warmverpflegung</option>
                            <option value="kalt">Kaltverpflegung</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>Verpflegungstyp:</label>
                        <select id="verpflegungstyp">
                            <option value="">Alle</option>
                            <option value="voll">Vollverpflegung</option>
                            <option value="lunch">Lunchpakete</option>
                            <option value="hand">Handverpflegung</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>
                            <input type="checkbox" id="vegetarisch">
                            Nur vegetarische Rezepte
                        </label>
                    </div>
                </div>

                <!-- Personenanzahl -->
                <div class="personen-input">
                    <label for="personen">Personenanzahl:</label>
                    <input type="number" id="personen" min="1" max="400" value="50">
                    <small>Basis: 50 Personen für SEG-Einsatz</small>
                </div>

                <!-- Rezepte Grid -->
                <div class="rezepte-grid" id="rezepte-grid">
                    <!-- Rezepte werden hier dynamisch eingefügt -->
                </div>

                <!-- Ausgewähltes Rezept -->
                <div id="rezept-details" class="rezept-details" style="display: none;">
                    <div class="rezept-header">
                        <h3 id="rezept-titel"></h3>
                        <div class="rezept-meta">
                            <span id="rezept-kalorien"></span>
                            <span id="rezept-zubereitungszeit"></span>
                            <span id="rezept-art"></span>
                        </div>
                    </div>
                    
                    <div class="rezept-content">
                        <div class="zutaten-section">
                            <h4>Zutaten für <span id="zutaten-personen">50</span> Personen</h4>
                            <ul id="rezept-zutaten"></ul>
                        </div>
                        
                        <div class="zubereitung-section">
                            <h4>Zubereitung</h4>
                            <ol id="rezept-zubereitung"></ol>
                        </div>
                        
                        <div class="portionierung-section">
                            <h4>Portionierung & Getränke</h4>
                            <p id="rezept-portionierung"></p>
                        </div>
                    </div>
                    
                    <div class="rezept-actions">
                        <button onclick="exportRezeptPDF()">Rezept als PDF exportieren</button>
                        <button onclick="zurEinkaufsliste()">Zur Einkaufsliste</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Einkaufsliste-Seite -->
        <div id="einkaufsliste" class="page">
            <div class="container">
                <h2>Einkaufsliste</h2>
                
                <div class="einkaufsliste-info">
                    <p>Für <span id="einkauf-personen">50</span> Personen | 
                       <strong id="einkauf-rezept-titel">Kein Rezept ausgewählt</strong>
                    </p>
                    <div>
                        <button onclick="exportEinkaufslistePDF()">Einkaufsliste als PDF exportieren</button>
                        <button onclick="showPage('rezepte')">Zurück zu Rezepten</button>
                    </div>
                </div>
                
                <div id="einkaufsliste-content">
                    <p>Bitte wähle zuerst ein Rezept auf der Rezept-Seite aus.</p>
                </div>
            </div>
        </div>

        <!-- Lager-Seite -->
        <div id="lager" class="page">
            <div class="container">
                <h2>Lagerverwaltung</h2>
                
                <!-- Lager-Statistiken -->
                <div class="lager-stats" id="lager-stats">
                    <!-- Statistiken werden dynamisch eingefügt -->
                </div>

                <!-- Lager-Controls -->
                <div class="lager-controls">
                    <div class="lager-form">
                        <div class="form-group">
                            <label for="neues-item">Artikelname</label>
                            <input type="text" id="neues-item" placeholder="z.B. Kartoffeln">
                        </div>
                        <div class="form-group">
                            <label for="neue-einheit">Einheit</label>
                            <select id="neue-einheit">
                                <option value="kg">kg</option>
                                <option value="g">g</option>
                                <option value="l">l</option>
                                <option value="ml">ml</option>
                                <option value="Stück">Stück</option>
                                <option value="Packungen">Packungen</option>
                                <option value="Dosen">Dosen</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="neue-menge">Menge</label>
                            <input type="number" id="neue-menge" min="0" step="0.1" value="0">
                        </div>
                        <div class="form-group">
                            <label for="neue-mindestmenge">Mindestmenge</label>
                            <input type="number" id="neue-mindestmenge" min="0" step="0.1" value="0">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button class="success" onclick="neuesLagerItem()">Hinzufügen</button>
                        </div>
                    </div>
                </div>

                <!-- Lager-Tabelle -->
                <div class="lager-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Artikel</th>
                                <th>Einheit</th>
                                <th>Menge</th>
                                <th>Mindestmenge</th>
                                <th>Status</th>
                                <th>Aktionen</th>
                            </tr>
                        </thead>
                        <tbody id="lager-tabelle">
                            <!-- Lagerdaten werden dynamisch eingefügt -->
                        </tbody>
                    </table>
                </div>

                <!-- Lager-Aktionen -->
                <div class="rezept-actions">
                    <button onclick="lagerExportieren()">Lager als CSV exportieren</button>
                    <button class="secondary" onclick="lagerImportieren()">Lager importieren</button>
                    <button class="warning" onclick="lagerLeeren()">Lager zurücksetzen</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Versteckte Druck-Container -->
    <div id="druck-rezept-container" class="druck-container" style="display: none;"></div>
    <div id="druck-einkaufsliste-container" class="druck-container" style="display: none;"></div>

    <!-- Versteckter Datei-Input für Import -->
    <input type="file" id="lager-import-file" accept=".csv" style="display: none;">

    <script>
        // Upstash Redis Konfiguration
        const UPSTASH_CONFIG = {
            URL: "https://helping-cougar-30935.upstash.io",
            TOKEN: "AXjXAAIncDJhNzc0OTViMWEwZGI0MDdlYmRjNWFhOTYxYjRmNjVhYXAyMzA5MzU",
            READ_ONLY_TOKEN: "AnjXAAIgcDKLfeRS33kEwLSXH-5rwwYziTlTxrIHmmAT-n9rbo_Elg"
        };

        // Rezepte Daten - SEG-optimiert mit Getränken und ohne Backen
        const rezepteDaten = [
            {
                id: 1,
                titel: "SEG-Eintopf mit Rindfleisch",
                beschreibung: "Kraftvoller Eintopf für kalte Einsatztage",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: false,
                kalorien: 650,
                basisZeit: 60,
                zutaten: [
                    { menge: 7500, einheit: "g", name: "Rindfleisch, gewürfelt" },
                    { menge: 50, einheit: "", name: "Kartoffeln, gewürfelt" },
                    { menge: 30, einheit: "", name: "Karotten, in Scheiben" },
                    { menge: 20, einheit: "", name: "Zwiebeln, gewürfelt" },
                    { menge: 10, einheit: "", name: "Sellerie, gewürfelt" },
                    { menge: 200, einheit: "g", name: "Tomatenmark" },
                    { menge: 25, einheit: "l", name: "Rinderbrühe" },
                    { menge: 100, einheit: "g", name: "Paprikapulver" },
                    { menge: 50, einheit: "g", name: "Majoran" },
                    { menge: 300, einheit: "ml", name: "Öl" },
                    { menge: 100, einheit: "g", name: "Salz" },
                    { menge: 50, einheit: "g", name: "Pfeffer" }
                ],
                zubereitung: [
                    "Rindfleisch in großen Bratentöpfen portionsweise scharf anbraten",
                    "Zwiebeln und Sellerie im Bratfond glasig dünsten",
                    "Tomatenmark zugeben und kurz mitrösten",
                    "Fleisch zurück in den Topf geben, mit Brühe ablöschen",
                    "Kartoffeln und Karotten hinzufügen, aufkochen lassen",
                    "Bei mittlerer Hitze 45 Minuten köcheln lassen",
                    "Gewürze zugeben und weitere 15 Minuten garen",
                    "Mit Salz und Pfeffer abschmecken"
                ],
                portionierung: "In Feldküchen-Schüsseln portionieren. Pro Person ca. 500ml Eintopf. Dazu 1 Liter Getränke pro Person (Wasser, Apfelschorle im Verhältnis 1:3). Mit frischem Brot servieren."
            },
            {
                id: 2,
                titel: "Nudelpfanne mit Gemüse und Tofu",
                beschreibung: "Vegetarische Pfanne für schnelle Verpflegung",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: true,
                kalorien: 580,
                basisZeit: 35,
                zutaten: [
                    { menge: 5000, einheit: "g", name: "Nudeln (Spiralnudeln)" },
                    { menge: 4000, einheit: "g", name: "Tofu, gewürfelt" },
                    { menge: 30, einheit: "", name: "Zucchini, in Scheiben" },
                    { menge: 25, einheit: "", name: "Paprika, gewürfelt" },
                    { menge: 20, einheit: "", name: "Zwiebeln, gewürfelt" },
                    { menge: 400, einheit: "g", name: "Tomatenmark" },
                    { menge: 300, einheit: "ml", name: "Sojasauce" },
                    { menge: 200, einheit: "ml", name: "Öl" },
                    { menge: 100, einheit: "g", name: "Knoblauch, gehackt" },
                    { menge: 80, einheit: "g", name: "Salz" },
                    { menge: 40, einheit: "g", name: "Pfeffer" },
                    { menge: 50, einheit: "g", name: "Paprikapulver" }
                ],
                zubereitung: [
                    "Nudeln in großen Töpfen bissfest kochen, abgießen",
                    "Tofu in Bratpfannen goldbraun anbraten",
                    "Zwiebeln und Knoblauch in Öl anschwitzen",
                    "Paprika und Zucchini zugeben, 5 Minuten braten",
                    "Tomatenmark und Gewürze zugeben, kurz mitrösten",
                    "Gekochte Nudeln und Tofu unterheben",
                    "Mit Sojasauce abschmecken, alles gut vermengen"
                ],
                portionierung: "In wärmeisolierten Behältern portionieren. Pro Person ca. 400g Nudelpfanne. Dazu 1 Liter Getränke pro Person (Wasser, Tee). Mit Sojajoghurt oder geriebenem Käse servieren."
            },
            {
                id: 3,
                titel: "SEG-Lunchpaket Standard",
                beschreibung: "Komplettes Lunchpaket für Tageseinsätze",
                verpflegungsart: "kalt",
                verpflegungstyp: "lunch",
                vegetarisch: true,
                kalorien: 850,
                basisZeit: 20,
                zutaten: [
                    { menge: 100, einheit: "", name: "Vollkornbrötchen" },
                    { menge: 2500, einheit: "g", name: "Käse, in Scheiben" },
                    { menge: 2500, einheit: "g", name: "Frischkäse" },
                    { menge: 1500, einheit: "g", name: "Vegetarischer Aufstrich" },
                    { menge: 50, einheit: "", name: "Äpfel" },
                    { menge: 50, einheit: "", name: "Bananen" },
                    { menge: 2500, einheit: "g", name: "Müsliriegel" },
                    { menge: 2500, einheit: "g", name: "Nüsse, gemischt" },
                    { menge: 100, einheit: "", name: "Schokoriegel" },
                    { menge: 50, einheit: "Päckchen", name: "Feuchttücher" }
                ],
                zubereitung: [
                    "Brötchen mit Frischkäse bestreichen",
                    "Käsescheiben und Aufstrich gleichmäßig verteilen",
                    "Jedes Lunchpaket mit 1 Brötchen, 1 Apfel, 1 Banane befüllen",
                    "Pro Paket 1 Müsliriegel, 1 Schokoriegel und 1 Nuss-Portion hinzufügen",
                    "Feuchttücher separat beipacken",
                    "Pakete in Papiertüten oder Frischhalteboxen verpacken"
                ],
                portionierung: "Pro Person 1 Lunchpaket. Zusätzlich 1 Liter Getränke pro Person (Mineralwasser, Saftschorle). Pakete beschriften und nach Einheit/Einsatzbereich sortieren."
            },
            {
                id: 4,
                titel: "Energie-Handverpflegung",
                beschreibung: "Kompakte Verpflegung für kurze Einsätze",
                verpflegungsart: "kalt",
                verpflegungstyp: "hand",
                vegetarisch: true,
                kalorien: 450,
                basisZeit: 10,
                zutaten: [
                    { menge: 5000, einheit: "g", name: "Müsliriegel" },
                    { menge: 5000, einheit: "g", name: "Studentenfutter" },
                    { menge: 2500, einheit: "g", name: "Trockenfrüchte" },
                    { menge: 2500, einheit: "g", name: "Kekse" },
                    { menge: 100, einheit: "", name: "Energieriegel" },
                    { menge: 50, einheit: "Päckchen", name: "Kaugummi" }
                ],
                zubereitung: [
                    "Alle Komponenten nach Arten sortieren",
                    "Pro Person 2 Müsliriegel, 1 Handvoll Studentenfutter portionieren",
                    "Trockenfrüchte und Kekse gleichmäßig aufteilen",
                    "Energieriegel und Kaugummi hinzufügen",
                    "In wiederverschließbare Beutel abfüllen",
                    "Beutel beschriften und stapeln"
                ],
                portionierung: "Pro Person 1 Handverpflegungsbeutel. Zusätzlich 1 Liter Getränke pro Person (Isotonische Getränke, Wasser). Für Einsätze unter 4 Stunden geeignet."
            },
            {
                id: 5,
                titel: "Kartoffel-Gemüse-Pfanne",
                beschreibung: "Einfache, nahrhafte Pfanne aus Feldküche",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: true,
                kalorien: 520,
                basisZeit: 40,
                zutaten: [
                    { menge: 60, einheit: "", name: "Kartoffeln, gewürfelt" },
                    { menge: 30, einheit: "", name: "Karotten, in Scheiben" },
                    { menge: 20, einheit: "", name: "Zwiebeln, gewürfelt" },
                    { menge: 15, einheit: "", name: "Lauch, in Ringen" },
                    { menge: 4000, einheit: "g", name: "Tiefkühl-Erbsen" },
                    { menge: 300, einheit: "ml", name: "Öl" },
                    { menge: 150, einheit: "g", name: "Senf" },
                    { menge: 100, einheit: "g", name: "Salz" },
                    { menge: 50, einheit: "g", name: "Pfeffer" },
                    { menge: 30, einheit: "g", name: "Kümmel" },
                    { menge: 20, einheit: "g", name: "Paprikapulver" }
                ],
                zubereitung: [
                    "Kartoffeln und Karotten in Salzwasser 15 Minuten vorkochen",
                    "Zwiebeln und Lauch in großen Pfannen anschwitzen",
                    "Vorgekochte Kartoffeln und Karotten zugeben",
                    "Bei mittlerer Hitze 10 Minuten braten bis goldbraun",
                    "Tiefkühlerbsen zugeben, 5 Minuten mitgaren",
                    "Senf und Gewürze unterrühren, abschmecken"
                ],
                portionierung: "In wärmeisolierten Behältern portionieren. Pro Person ca. 400g Pfannengericht. Dazu 1 Liter Getränke pro Person (Wasser, Tee). Mit Senf oder Ketchup servieren."
            },
            {
                id: 6,
                titel: "Notfall-Handverpflegung",
                beschreibung: "Minimalistische Verpflegung für Akuteinsätze",
                verpflegungsart: "kalt",
                verpflegungstyp: "hand",
                vegetarisch: true,
                kalorien: 300,
                basisZeit: 5,
                zutaten: [
                    { menge: 100, einheit: "", name: "Energieriegel" },
                    { menge: 5000, einheit: "g", name: "Traubenzucker" },
                    { menge: 50, einheit: "Päckchen", name: "Salzstangen" },
                    { menge: 50, einheit: "Päckchen", name: "Kekse" }
                ],
                zubereitung: [
                    "Energieriegel und Traubenzucker sortieren",
                    "Pro Person 2 Energieriegel, 1 Päckchen Salzstangen portionieren",
                    "Traubenzucker und Kekse gleichmäßig verteilen",
                    "In kleine Beutel oder Tüten abfüllen",
                    "Für schnelle Verteilung bereitstellen"
                ],
                portionierung: "Pro Person 1 Notfallpaket. Zusätzlich 0,5 Liter Wasser pro Person. Nur für Einsätze unter 2 Stunden oder als Überbrückung bis zur Hauptverpflegung."
            },
            {
                id: 7,
                titel: "Gulasch mit Kartoffeln",
                beschreibung: "Klassisches Gulasch für Kraftspender",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: false,
                kalorien: 680,
                basisZeit: 75,
                zutaten: [
                    { menge: 8000, einheit: "g", name: "Rindergulasch" },
                    { menge: 60, einheit: "", name: "Kartoffeln, gewürfelt" },
                    { menge: 25, einheit: "", name: "Zwiebeln, gewürfelt" },
                    { menge: 200, einheit: "g", name: "Tomatenmark" },
                    { menge: 150, einheit: "g", name: "Paprikapulver, edelsüß" },
                    { menge: 50, einheit: "g", name: "Kümmel, gemahlen" },
                    { menge: 30, einheit: "l", name: "Rinderfond" },
                    { menge: 400, einheit: "ml", name: "Öl" },
                    { menge: 120, einheit: "g", name: "Salz" },
                    { menge: 60, einheit: "g", name: "Pfeffer" }
                ],
                zubereitung: [
                    "Rindergulasch portionsweise scharf anbraten",
                    "Zwiebeln glasig dünsten, Tomatenmark zugeben",
                    "Paprikapulver einrühren, kurz mitrösten",
                    "Fleisch zurückgeben, mit Fond ablöschen",
                    "2 Stunden bei kleiner Hitze schmoren lassen",
                    "Kartoffeln zugeben, weitere 30 Minuten garen",
                    "Mit Salz, Pfeffer und Kümmel abschmecken"
                ],
                portionierung: "Pro Person 500ml Gulasch mit Kartoffeln. Dazu 1 Liter Getränke (Wasser, Malzbier). Mit frischem Brot servieren."
            },
            {
                id: 8,
                titel: "Gemüse-Curry mit Reis",
                beschreibung: "Würziges Curry für vegetarische Verpflegung",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: true,
                kalorien: 560,
                basisZeit: 45,
                zutaten: [
                    { menge: 6000, einheit: "g", name: "Reis, langkorn" },
                    { menge: 40, einheit: "", name: "Kartoffeln, gewürfelt" },
                    { menge: 25, einheit: "", name: "Karotten, in Scheiben" },
                    { menge: 20, einheit: "", name: "Zwiebeln, gewürfelt" },
                    { menge: 15, einheit: "", name: "Paprika, gewürfelt" },
                    { menge: 8000, einheit: "g", name: "Kokosmilch" },
                    { menge: 200, einheit: "g", name: "Currypaste, gelb" },
                    { menge: 150, einheit: "g", name: "Currypulver" },
                    { menge: 100, einheit: "g", name: "Knoblauch, gehackt" },
                    { menge: 50, einheit: "g", name: "Ingwer, gerieben" },
                    { menge: 300, einheit: "ml", name: "Öl" },
                    { menge: 100, einheit: "g", name: "Salz" }
                ],
                zubereitung: [
                    "Reis nach Packungsanleitung kochen",
                    "Zwiebeln, Knoblauch und Ingwer in Öl anschwitzen",
                    "Currypaste zugeben, kurz anbraten",
                    "Gemüse hinzufügen, 5 Minuten mitdünsten",
                    "Kokosmilch angießen, aufkochen lassen",
                    "20 Minuten bei mittlerer Hitze köcheln",
                    "Mit Salz und Currypulver abschmecken"
                ],
                portionierung: "Pro Person 200g Reis mit 300ml Curry. Dazu 1 Liter Getränke (Wasser, Tee). Mit frischen Kräutern garnieren."
            },
            {
                id: 9,
                titel: "Bratwurst mit Kartoffelsalat",
                beschreibung: "Deftige Mahlzeit für Einsatzkräfte",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: false,
                kalorien: 720,
                basisZeit: 50,
                zutaten: [
                    { menge: 100, einheit: "", name: "Bratwürste" },
                    { menge: 80, einheit: "", name: "Kartoffeln, festkochend" },
                    { menge: 20, einheit: "", name: "Zwiebeln, gewürfelt" },
                    { menge: 1500, einheit: "ml", name: "Brühe" },
                    { menge: 1000, einheit: "ml", name: "Essig" },
                    { menge: 500, einheit: "ml", name: "Öl" },
                    { menge: 300, einheit: "g", name: "Senf" },
                    { menge: 200, einheit: "g", name: "Gurken, gewürfelt" },
                    { menge: 100, einheit: "g", name: "Salz" },
                    { menge: 50, einheit: "g", name: "Pfeffer" },
                    { menge: 50, einheit: "g", name: "Zucker" }
                ],
                zubereitung: [
                    "Kartoffeln kochen, schälen und in Scheiben schneiden",
                    "Brühe, Essig, Öl und Gewürze zur Marinade verrühren",
                    "Kartoffelscheiben mit Zwiebeln und Gurken mischen",
                    "Marinade darüber gießen, ziehen lassen",
                    "Bratwürste grillen oder braten",
                    "Kartoffelsalat mindestens 1 Stunde durchziehen lassen"
                ],
                portionierung: "Pro Person 1 Bratwurst mit 300g Kartoffelsalat. Dazu 1 Liter Getränke (Wasser, Apfelschorle). Mit Senf und Brot servieren."
            },
            {
                id: 10,
                titel: "Linseneintopf mit Würstchen",
                beschreibung: "Nahrhafter Eintopf mit hohem Eiweißgehalt",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: false,
                kalorien: 590,
                basisZeit: 55,
                zutaten: [
                    { menge: 5000, einheit: "g", name: "Linsen, trocken" },
                    { menge: 75, einheit: "", name: "Wiener Würstchen" },
                    { menge: 25, einheit: "", name: "Zwiebeln, gewürfelt" },
                    { menge: 20, einheit: "", name: "Karotten, gewürfelt" },
                    { menge: 15, einheit: "", name: "Sellerie, gewürfelt" },
                    { menge: 30, einheit: "l", name: "Gemüsebrühe" },
                    { menge: 200, einheit: "g", name: "Tomatenmark" },
                    { menge: 150, einheit: "g", name: "Majoran" },
                    { menge: 100, einheit: "g", name: "Thymian" },
                    { menge: 250, einheit: "ml", name: "Öl" },
                    { menge: 120, einheit: "g", name: "Salz" },
                    { menge: 60, einheit: "g", name: "Pfeffer" }
                ],
                zubereitung: [
                    "Zwiebeln, Karotten und Sellerie in Öl anschwitzen",
                    "Tomatenmark zugeben, kurz mitrösten",
                    "Linsen hinzufügen, mit Brühe ablöschen",
                    "45 Minuten köcheln lassen, bis Linsen weich sind",
                    "Würstchen in Scheiben schneiden, zugeben",
                    "10 Minuten mitgaren, mit Gewürzen abschmecken"
                ],
                portionierung: "Pro Person 500ml Linseneintopf. Dazu 1 Liter Getränke (Wasser, Tee). Mit Brot oder Brötchen servieren."
            },
            {
                id: 11,
                titel: "Käsespätzle mit Röstzwiebeln",
                beschreibung: "Beliebtes Gericht für kalte Tage",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: true,
                kalorien: 610,
                basisZeit: 40,
                zutaten: [
                    { menge: 8000, einheit: "g", name: "Spätzle, frisch" },
                    { menge: 4000, einheit: "g", name: "Bergkäse, gerieben" },
                    { menge: 1000, einheit: "g", name: "Emmentaler, gerieben" },
                    { menge: 500, einheit: "g", name: "Röstzwiebeln" },
                    { menge: 400, einheit: "ml", name: "Öl" },
                    { menge: 300, einheit: "g", name: "Butter" },
                    { menge: 150, einheit: "g", name: "Muskatnuss" },
                    { menge: 100, einheit: "g", name: "Salz" },
                    { menge: 50, einheit: "g", name: "Pfeffer" }
                ],
                zubereitung: [
                    "Spätzle in kochendem Salzwasser al dente kochen",
                    "Abgießen und gut abtropfen lassen",
                    "Butter in großen Pfannen schmelzen",
                    "Spätzle darin schwenken",
                    "Käse unterheben, schmelzen lassen",
                    "Mit Muskat, Salz und Pfeffer würzen",
                    "Röstzwiebeln darüber streuen"
                ],
                portionierung: "Pro Person 300g Käsespätzle. Dazu 1 Liter Getränke (Wasser, Apfelsaftschorle). Mit grünem Salat servieren."
            },
            {
                id: 12,
                titel: "Chili con Carne",
                beschreibung: "Würziges Chili für anstrengende Einsätze",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: false,
                kalorien: 670,
                basisZeit: 70,
                zutaten: [
                    { menge: 6000, einheit: "g", name: "Hackfleisch, gemischt" },
                    { menge: 8000, einheit: "g", name: "Kidneybohnen, Dose" },
                    { menge: 4000, einheit: "g", name: "Mais, Dose" },
                    { menge: 30, einheit: "", name: "Zwiebeln, gewürfelt" },
                    { menge: 1000, einheit: "g", name: "Tomaten, stückig" },
                    { menge: 200, einheit: "g", name: "Chilipulver" },
                    { menge: 150, einheit: "g", name: "Kreuzkümmel" },
                    { menge: 100, einheit: "g", name: "Oregano" },
                    { menge: 400, einheit: "ml", name: "Öl" },
                    { menge: 120, einheit: "g", name: "Salz" },
                    { menge: 50, einheit: "g", name: "Knoblauch, gehackt" }
                ],
                zubereitung: [
                    "Hackfleisch in Portionen scharf anbraten",
                    "Zwiebeln und Knoblauch zugeben, glasig dünsten",
                    "Gewürze zugeben, kurz mitrösten",
                    "Tomaten, Bohnen und Mais hinzufügen",
                    "60 Minuten bei kleiner Hitze köcheln lassen",
                    "Mit Salz und weiteren Gewürzen abschmecken"
                ],
                portionierung: "Pro Person 400ml Chili con Carne. Dazu 1 Liter Getränke (Wasser, isotonische Getränke). Mit Reis oder Brot servieren."
            },
            {
                id: 13,
                titel: "Gemüse-Reis-Pfanne mit Hähnchen",
                beschreibung: "Leichte Pfanne für warme Tage",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: false,
                kalorien: 540,
                basisZeit: 35,
                zutaten: [
                    { menge: 6000, einheit: "g", name: "Reis, gekocht" },
                    { menge: 8000, einheit: "g", name: "Hähnchenbrust, gewürfelt" },
                    { menge: 25, einheit: "", name: "Paprika, gewürfelt" },
                    { menge: 20, einheit: "", name: "Zucchini, gewürfelt" },
                    { menge: 15, einheit: "", name: "Karotten, gewürfelt" },
                    { menge: 400, einheit: "ml", name: "Sojasauce" },
                    { menge: 300, einheit: "ml", name: "Öl" },
                    { menge: 100, einheit: "g", name: "Ingwer, gerieben" },
                    { menge: 80, einheit: "g", name: "Knoblauch, gehackt" },
                    { menge: 100, einheit: "g", name: "Salz" },
                    { menge: 50, einheit: "g", name: "Pfeffer" }
                ],
                zubereitung: [
                    "Hähnchenwürfel in Öl anbraten, herausnehmen",
                    "Gemüse im Wok kurz anbraten",
                    "Ingwer und Knoblauch zugeben",
                    "Reis hinzufügen, mitbraten",
                    "Hähnchen zurückgeben",
                    "Mit Sojasauce ablöschen, abschmecken"
                ],
                portionierung: "Pro Person 350g Reis-Pfanne. Dazu 1 Liter Getränke (Wasser, Tee). Mit Sojasauce extra servieren."
            },
            {
                id: 14,
                titel: "Kürbissuppe mit Croutons",
                beschreibung: "Cremige Suppe für herbstliche Einsätze",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: true,
                kalorien: 480,
                basisZeit: 45,
                zutaten: [
                    { menge: 40, einheit: "", name: "Hokkaido-Kürbis" },
                    { menge: 15, einheit: "", name: "Kartoffeln, gewürfelt" },
                    { menge: 10, einheit: "", name: "Zwiebeln, gewürfelt" },
                    { menge: 20, einheit: "l", name: "Gemüsebrühe" },
                    { menge: 1000, einheit: "ml", name: "Sahne" },
                    { menge: 200, einheit: "g", name: "Ingwer, gerieben" },
                    { menge: 150, einheit: "g", name: "Currypulver" },
                    { menge: 100, einheit: "g", name: "Muskatnuss" },
                    { menge: 300, einheit: "ml", name: "Öl" },
                    { menge: 120, einheit: "g", name: "Salz" },
                    { menge: 2000, einheit: "g", name: "Brotwürfel für Croutons" }
                ],
                zubereitung: [
                    "Kürbis und Kartoffeln schälen, würfeln",
                    "Zwiebeln in Öl glasig dünsten",
                    "Kürbis und Kartoffeln zugeben, kurz mitdünsten",
                    "Mit Brühe ablöschen, 25 Minuten kochen",
                    "Pürieren, Sahne unterrühren",
                    "Mit Gewürzen abschmecken",
                    "Croutons in Öl goldbraun rösten"
                ],
                portionierung: "Pro Person 400ml Suppe mit Croutons. Dazu 1 Liter Getränke (Wasser, Apfelsaft). Mit frischem Brot servieren."
            },
            {
                id: 15,
                titel: "SEG-Brotzeitpaket",
                beschreibung: "Bayrische Brotzeit für Zwischendurch",
                verpflegungsart: "kalt",
                verpflegungstyp: "lunch",
                vegetarisch: false,
                kalorien: 780,
                basisZeit: 25,
                zutaten: [
                    { menge: 100, einheit: "", name: "Brezeln" },
                    { menge: 100, einheit: "", name: "Brötchen" },
                    { menge: 3000, einheit: "g", name: "Obazda/Käsecreme" },
                    { menge: 2000, einheit: "g", name: "Leberkäse, in Scheiben" },
                    { menge: 1500, einheit: "g", name: "Radi, geputzt" },
                    { menge: 2000, einheit: "g", name: "Gurken, sauer" },
                    { menge: 100, einheit: "", name: "Äpfel" },
                    { menge: 50, einheit: "Päckchen", name: "Senf" },
                    { menge: 50, einheit: "Päckchen", name: "Meerrettich" }
                ],
                zubereitung: [
                    "Brezeln und Brötchen in Tüten packen",
                    "Obazda in Portionsschälchen abfüllen",
                    "Leberkäse in Scheiben schneiden, portionieren",
                    "Radi und Gurken waschen, portionieren",
                    "Äpfel waschen, pro Paket 1 Stück",
                    "Senf und Meerrettich beipacken",
                    "Alles in Brotzeitboxen anrichten"
                ],
                portionierung: "Pro Person 1 Brotzeitpaket. Dazu 1 Liter Getränke (Wasser, Radler). Für Zwischenverpflegung geeignet."
            },
            {
                id: 16,
                titel: "Protein-Power-Paket",
                beschreibung: "Eiweißreiche Verpflegung für körperliche Arbeit",
                verpflegungsart: "kalt",
                verpflegungstyp: "hand",
                vegetarisch: true,
                kalorien: 520,
                basisZeit: 15,
                zutaten: [
                    { menge: 4000, einheit: "g", name: "Eiweißriegel" },
                    { menge: 3000, einheit: "g", name: "Studentenfutter" },
                    { menge: 2000, einheit: "g", name: "Kürbiskerne" },
                    { menge: 2000, einheit: "g", name: "Sonnenblumenkerne" },
                    { menge: 3000, einheit: "g", name: "Trockenfrüchte" },
                    { menge: 100, einheit: "", name: "Protein-Shakes" }
                ],
                zubereitung: [
                    "Alle Komponenten nach Art sortieren",
                    "Pro Person 2 Eiweißriegel portionieren",
                    "Handvoll Studentenfutter abmessen",
                    "Kerne und Samen mischen, portionieren",
                    "Protein-Shakes kühl halten",
                    "In robuste Beutel verpacken"
                ],
                portionierung: "Pro Person 1 Protein-Paket mit 1 Protein-Shake. Zusätzlich 1,5 Liter Wasser pro Person. Für schwere körperliche Arbeit geeignet."
            },
            {
                id: 17,
                titel: "Italienische Nudelpfanne",
                beschreibung: "Mediterrane Pfanne für Abwechslung",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: true,
                kalorien: 570,
                basisZeit: 30,
                zutaten: [
                    { menge: 5000, einheit: "g", name: "Penne-Nudeln" },
                    { menge: 8000, einheit: "g", name: "Tomaten, stückig" },
                    { menge: 3000, einheit: "g", name: "Mozzarella, gewürfelt" },
                    { menge: 500, einheit: "g", name: "Basilikum, frisch" },
                    { menge: 300, einheit: "ml", name: "Olivenöl" },
                    { menge: 200, einheit: "g", name: "Knoblauch, gehackt" },
                    { menge: 150, einheit: "g", name: "Oregano" },
                    { menge: 100, einheit: "g", name: "Salz" },
                    { menge: 50, einheit: "g", name: "Pfeffer" },
                    { menge: 1000, einheit: "g", name: "Parmesan, gerieben" }
                ],
                zubereitung: [
                    "Nudeln bissfest kochen, abgießen",
                    "Knoblauch in Olivenöl anschwitzen",
                    "Tomaten zugeben, 10 Minuten köcheln",
                    "Gewürze und Basilikum unterrühren",
                    "Nudeln und Mozzarella unterheben",
                    "Mit Parmesan bestreuen"
                ],
                portionierung: "Pro Person 350g Nudelpfanne. Dazu 1 Liter Getränke (Wasser, Mineralwasser). Mit frischem Basilikum garnieren."
            },
            {
                id: 18,
                titel: "Asiatische Gemüsepfanne",
                beschreibung: "Wok-Gericht mit asiatischen Aromen",
                verpflegungsart: "warm",
                verpflegungstyp: "voll",
                vegetarisch: true,
                kalorien: 530,
                basisZeit: 25,
                zutaten: [
                    { menge: 6000, einheit: "g", name: "Reisnudeln" },
                    { menge: 30, einheit: "", name: "Frühlingszwiebeln, in Ringen" },
                    { menge: 25, einheit: "", name: "Möhren, in Streifen" },
                    { menge: 20, einheit: "", name: "Paprika, in Streifen" },
                    { menge: 4000, einheit: "g", name: "Sojasprossen" },
                    { menge: 500, einheit: "ml", name: "Sojasauce" },
                    { menge: 300, einheit: "ml", name: "Sesamöl" },
                    { menge: 200, einheit: "g", name: "Ingwer, gerieben" },
                    { menge: 100, einheit: "g", name: "Chiliflocken" },
                    { menge: 150, einheit: "g", name: "Sesam, geröstet" }
                ],
                zubereitung: [
                    "Reisnudeln nach Packungsanweisung zubereiten",
                    "Gemüse im Wok kurz und scharf anbraten",
                    "Ingwer und Chili zugeben",
                    "Nudeln unterheben",
                    "Mit Sojasauce und Sesamöl abschmecken",
                    "Mit Sesam bestreuen"
                ],
                portionierung: "Pro Person 350g Nudelpfanne. Dazu 1 Liter Getränke (Wasser, grüner Tee). Mit Limettenspalten servieren."
            },
            {
                id: 19,
                titel: "Kalter Teller für heiße Tage",
                beschreibung: "Erfrischende kalte Platte",
                verpflegungsart: "kalt",
                verpflegungstyp: "voll",
                vegetarisch: false,
                kalorien: 620,
                basisZeit: 35,
                zutaten: [
                    { menge: 75, einheit: "", name: "Geflügelbrust, gekocht" },
                    { menge: 50, einheit: "", name: "Eier, gekocht" },
                    { menge: 40, einheit: "", name: "Tomaten" },
                    { menge: 40, einheit: "", name: "Gurken" },
                    { menge: 3000, einheit: "g", name: "Kartoffelsalat" },
                    { menge: 2000, einheit: "g", name: "Kräuterquark" },
                    { menge: 100, einheit: "", name: "Brötchen" },
                    { menge: 50, einheit: "Päckchen", name: "Senf" },
                    { menge: 50, einheit: "Päckchen", name: "Mayonnaise" }
                ],
                zubereitung: [
                    "Geflügelbrust in Scheiben schneiden",
                    "Eier schälen, halbieren",
                    "Tomaten und Gurken waschen, schneiden",
                    "Kartoffelsalat und Kräuterquark portionieren",
                    "Alles auf Tellern anrichten",
                    "Brötchen und Saucen separat dazu"
                ],
                portionierung: "Pro Person 1 kalten Teller. Dazu 1,5 Liter Getränke (Wasser, Eistee). Für heiße Einsatztage geeignet."
            },
            {
                id: 20,
                titel: "24-Stunden-Notfallpaket",
                beschreibung: "Komplettverpflegung für Tageseinsätze",
                verpflegungsart: "kalt",
                verpflegungstyp: "lunch",
                vegetarisch: true,
                kalorien: 2200,
                basisZeit: 40,
                zutaten: [
                    { menge: 150, einheit: "", name: "Müsliriegel" },
                    { menge: 150, einheit: "", name: "Energieriegel" },
                    { menge: 7500, einheit: "g", name: "Studentenfutter" },
                    { menge: 5000, einheit: "g", name: "Trockenfrüchte" },
                    { menge: 5000, einheit: "g", name: "Kekse" },
                    { menge: 150, einheit: "", name: "Fertiggerichte (selbsterhitzend)" },
                    { menge: 150, einheit: "Päckchen", name: "Instantkaffee" },
                    { menge: 150, einheit: "Päckchen", name: "Zucker" },
                    { menge: 150, einheit: "Päckchen", name: "Milchpulver" }
                ],
                zubereitung: [
                    "Alle Komponenten nach Mahlzeiten sortieren",
                    "Frühstück: Müsliriegel, Kaffee, Kekse",
                    "Mittag: Fertiggericht, Energieriegel",
                    "Abend: Studentenfutter, Trockenfrüchte",
                    "In Tagesrationen verpacken",
                    "Beschriften und stapeln"
                ],
                portionierung: "Pro Person 1 24-Stunden-Paket. Zusätzlich 3 Liter Wasser pro Person. Für komplette Tagesverpflegung ohne Küche."
            }
        ];

        // Globale Variablen
        let aktuellesRezept = null;
        let personenAnzahl = 50; // BASIS: 50 Personen für SEG
        let lagerDaten = [];

        // NEUE FUNKTION: Berechnet skalierte Zubereitungszeit
        function berechneZubereitungszeit(basisZeit, personenAnzahl) {
            // Basis: Zeit für 50 Personen
            const basisFaktor = 1.0; // 50 Personen = 100%
            
            // Nicht-lineare Skalierung für realistischere Zeiten:
            if (personenAnzahl <= 50) {
                // Bis 50 Personen: annähernd linear
                return Math.round(basisZeit * (personenAnzahl / 50));
            } else if (personenAnzahl <= 100) {
                // 50-100 Personen: reduzierte Skalierung
                const zusatzFaktor = 0.7; // Jede weitere Person nur 70% mehr Zeit
                return Math.round(basisZeit * (1 + ((personenAnzahl - 50) / 50) * zusatzFaktor));
            } else {
                // Über 100 Personen: weitere Reduzierung
                const zusatzFaktor = 0.5; // Jede weitere Person nur 50% mehr Zeit
                return Math.round(basisZeit * (2 + ((personenAnzahl - 100) / 50) * zusatzFaktor));
            }
        }

        // LAGER-FUNKTIONEN
        async function lagerDatenLaden() {
            try {
                console.log('Lade Lagerdaten von Upstash...');
                
                const response = await fetch(`${UPSTASH_CONFIG.URL}/get/lager`, {
                    headers: {
                        'Authorization': `Bearer ${UPSTASH_CONFIG.TOKEN}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.result) {
                    lagerDaten = JSON.parse(data.result);
                    console.log('Lagerdaten erfolgreich geladen:', lagerDaten);
                } else {
                    // Fallback: Standard-Lagerdaten
                    lagerDaten = [
                        { name: "Kartoffeln", einheit: "kg", menge: 100, mindestmenge: 50 },
                        { name: "Karotten", einheit: "kg", menge: 30, mindestmenge: 15 },
                        { name: "Zwiebeln", einheit: "kg", menge: 20, mindestmenge: 10 },
                        { name: "Nudeln", einheit: "kg", menge: 50, mindestmenge: 25 },
                        { name: "Reis", einheit: "kg", menge: 40, mindestmenge: 20 },
                        { name: "Öl", einheit: "l", menge: 20, mindestmenge: 10 },
                        { name: "Wasser", einheit: "l", menge: 200, mindestmenge: 100 },
                        { name: "Konserven", einheit: "Dosen", menge: 100, mindestmenge: 50 }
                    ];
                    console.log('Standard-Lagerdaten geladen');
                }
                
                lagerAnzeigen();
                
            } catch (error) {
                console.error('Fehler beim Laden der Lagerdaten:', error);
                // Fallback zu localStorage
                const localData = localStorage.getItem('lagerDaten');
                if (localData) {
                    lagerDaten = JSON.parse(localData);
                    console.log('Lagerdaten aus localStorage geladen');
                } else {
                    // Standard-Lagerdaten
                    lagerDaten = [
                        { name: "Kartoffeln", einheit: "kg", menge: 100, mindestmenge: 50 },
                        { name: "Karotten", einheit: "kg", menge: 30, mindestmenge: 15 },
                        { name: "Zwiebeln", einheit: "kg", menge: 20, mindestmenge: 10 },
                        { name: "Nudeln", einheit: "kg", menge: 50, mindestmenge: 25 },
                        { name: "Reis", einheit: "kg", menge: 40, mindestmenge: 20 },
                        { name: "Öl", einheit: "l", menge: 20, mindestmenge: 10 },
                        { name: "Wasser", einheit: "l", menge: 200, mindestmenge: 100 },
                        { name: "Konserven", einheit: "Dosen", menge: 100, mindestmenge: 50 }
                    ];
                    console.log('Standard-Lagerdaten geladen');
                }
                lagerAnzeigen();
            }
        }

        async function lagerDatenSpeichern() {
            try {
                console.log('Speichere Lagerdaten in Upstash...');
                
                const response = await fetch(`${UPSTASH_CONFIG.URL}/set/lager`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${UPSTASH_CONFIG.TOKEN}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(JSON.stringify(lagerDaten))
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                await response.json();
                console.log('Lagerdaten erfolgreich gespeichert');
                
            } catch (error) {
                console.error('Fehler beim Speichern der Lagerdaten:', error);
                // Fallback zu localStorage
                localStorage.setItem('lagerDaten', JSON.stringify(lagerDaten));
                console.log('Lagerdaten in localStorage gespeichert');
            }
        }

        function lagerAnzeigen() {
            const tabelle = document.getElementById('lager-tabelle');
            const statsContainer = document.getElementById('lager-stats');
            
            if (!tabelle || !statsContainer) return;
            
            // Statistiken berechnen
            const gesamtArtikel = lagerDaten.length;
            const niedrigerBestand = lagerDaten.filter(item => item.menge < item.mindestmenge).length;
            const kritischerBestand = lagerDaten.filter(item => item.menge < item.mindestmenge * 0.5).length;
            
            // Statistiken anzeigen
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <h3>Gesamtartikel</h3>
                    <div class="number">${gesamtArtikel}</div>
                </div>
                <div class="stat-card ${niedrigerBestand > 0 ? 'warning' : ''}">
                    <h3>Niedriger Bestand</h3>
                    <div class="number">${niedrigerBestand}</div>
                </div>
                <div class="stat-card ${kritischerBestand > 0 ? 'critical' : ''}">
                    <h3>Kritischer Bestand</h3>
                    <div class="number">${kritischerBestand}</div>
                </div>
            `;
            
            // Tabelle füllen
            tabelle.innerHTML = lagerDaten.map((item, index) => {
                const status = item.menge < item.mindestmenge * 0.5 ? 'critical-stock' : 
                              item.menge < item.mindestmenge ? 'low-stock' : '';
                const statusText = item.menge < item.mindestmenge * 0.5 ? 'Kritisch' : 
                                 item.menge < item.mindestmenge ? 'Niedrig' : 'OK';
                
                return `
                    <tr class="${status}">
                        <td>${item.name}</td>
                        <td>${item.einheit}</td>
                        <td>${item.menge}</td>
                        <td>${item.mindestmenge}</td>
                        <td>${statusText}</td>
                        <td class="lager-actions">
                            <button onclick="mengeAendern(${index}, 1)" class="success">+1</button>
                            <button onclick="mengeAendern(${index}, -1)" class="warning">-1</button>
                            <button onclick="lagerItemLoeschen(${index})" class="secondary">Löschen</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        async function neuesLagerItem() {
            const nameInput = document.getElementById('neues-item');
            const einheitInput = document.getElementById('neue-einheit');
            const mengeInput = document.getElementById('neue-menge');
            const mindestmengeInput = document.getElementById('neue-mindestmenge');
            
            const name = nameInput.value.trim();
            const einheit = einheitInput.value;
            const menge = parseFloat(mengeInput.value);
            const mindestmenge = parseFloat(mindestmengeInput.value);
            
            if (!name || isNaN(menge) || isNaN(mindestmenge)) {
                alert('Bitte füllen Sie alle Felder korrekt aus.');
                return;
            }
            
            // Prüfen ob Artikel bereits existiert
            const existiert = lagerDaten.find(item => 
                item.name.toLowerCase() === name.toLowerCase()
            );
            
            if (existiert) {
                alert('Dieser Artikel existiert bereits im Lager.');
                return;
            }
            
            const neuesItem = {
                name,
                einheit,
                menge,
                mindestmenge
            };
            
            lagerDaten.push(neuesItem);
            await lagerDatenSpeichern();
            lagerAnzeigen();
            
            // Formular zurücksetzen
            nameInput.value = '';
            mengeInput.value = '0';
            mindestmengeInput.value = '0';
        }

        async function mengeAendern(index, aenderung) {
            if (index < 0 || index >= lagerDaten.length) return;
            
            lagerDaten[index].menge += aenderung;
            
            // Negative Mengen verhindern
            if (lagerDaten[index].menge < 0) {
                lagerDaten[index].menge = 0;
            }
            
            await lagerDatenSpeichern();
            lagerAnzeigen();
        }

        async function lagerItemLoeschen(index) {
            if (confirm('Möchten Sie diesen Artikel wirklich löschen?')) {
                lagerDaten.splice(index, 1);
                await lagerDatenSpeichern();
                lagerAnzeigen();
            }
        }

        function lagerExportieren() {
            const csvHeader = 'Artikel,Einheit,Menge,Mindestmenge\n';
            const csvRows = lagerDaten.map(item => 
                `"${item.name}",${item.einheit},${item.menge},${item.mindestmenge}`
            ).join('\n');
            
            const csvContent = csvHeader + csvRows;
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            
            link.setAttribute('href', url);
            link.setAttribute('download', `lager_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function lagerImportieren() {
            document.getElementById('lager-import-file').click();
        }

        async function lagerLeeren() {
            if (confirm('Möchten Sie wirklich das gesamte Lager zurücksetzen? Diese Aktion kann nicht rückgängig gemacht werden.')) {
                lagerDaten = [];
                await lagerDatenSpeichern();
                lagerAnzeigen();
            }
        }

        // Event Listener für Datei-Import
        document.getElementById('lager-import-file').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csvText = e.target.result;
                    const lines = csvText.split('\n');
                    const newLagerDaten = [];
                    
                    // Header überspringen (erste Zeile)
                    for (let i = 1; i < lines.length; i++) {
                        const line = lines[i].trim();
                        if (!line) continue;
                        
                        const [name, einheit, menge, mindestmenge] = line.split(',').map(field => 
                            field.replace(/^"|"$/g, '') // Anführungszeichen entfernen
                        );
                        
                        if (name && einheit) {
                            newLagerDaten.push({
                                name,
                                einheit,
                                menge: parseFloat(menge) || 0,
                                mindestmenge: parseFloat(mindestmenge) || 0
                            });
                        }
                    }
                    
                    lagerDaten = newLagerDaten;
                    lagerDatenSpeichern();
                    lagerAnzeigen();
                    alert('Lager erfolgreich importiert!');
                    
                } catch (error) {
                    console.error('Fehler beim Importieren:', error);
                    alert('Fehler beim Importieren der CSV-Datei.');
                }
            };
            
            reader.readAsText(file);
            event.target.value = ''; // Reset file input
        });

        // Initialisierung
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM geladen - starte Initialisierung');
            
            // Event Listener für Filter
            document.getElementById('verpflegungsart').addEventListener('change', filterRezepte);
            document.getElementById('verpflegungstyp').addEventListener('change', filterRezepte);
            document.getElementById('vegetarisch').addEventListener('change', filterRezepte);
            
            // Personenanzahl Event-Listener
            document.getElementById('personen').addEventListener('input', function() {
                personenAnzahl = parseInt(this.value) || 1;
                console.log('Personenanzahl geändert:', personenAnzahl);
                
                // Personenanzahl in der Rezept-Anzeige aktualisieren
                document.getElementById('zutaten-personen').textContent = personenAnzahl;
                document.getElementById('einkauf-personen').textContent = personenAnzahl;
                
                // Rezept neu anzeigen mit neuer Personenanzahl
                if (aktuellesRezept) {
                    zeigeAusgewaehltesRezept(aktuellesRezept.id);
                }
                
                // Einkaufsliste aktualisieren
                aktualisiereEinkaufsliste();
            });

            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');
                    showPage(pageId);
                });
            });

            // Startseite anzeigen
            showPage('rezepte');
            
            // Browser Navigation behandeln
            window.addEventListener('popstate', function() {
                const hash = window.location.hash.replace('#', '') || 'rezepte';
                showPage(hash);
            });

            const initialPage = window.location.hash.replace('#', '') || 'rezepte';
            showPage(initialPage);
            
            // Rezepte initial laden
            filterRezepte();
            
            // Lager initial laden
            lagerDatenLaden();
        });

        // Seitenwechsel
        function showPage(pageId) {
            console.log('Wechsle zu Seite:', pageId);
            
            // Navigation aktualisieren
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === pageId) {
                    link.classList.add('active');
                }
            });

            // Alle Seiten ausblenden
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
                page.style.display = 'none';
            });
            
            // Nur die gewünschte Seite anzeigen
            const aktiveSeite = document.getElementById(pageId);
            if (aktiveSeite) {
                aktiveSeite.classList.add('active');
                aktiveSeite.style.display = 'block';
            }

            // URL aktualisieren
            window.history.pushState(null, null, `#${pageId}`);

            // Spezielle Aktionen pro Seite
            if (pageId === 'rezepte') {
                filterRezepte();
            } else if (pageId === 'einkaufsliste') {
                aktualisiereEinkaufsliste();
            } else if (pageId === 'lager') {
                lagerAnzeigen();
            }
        }

        // Rezepte filtern und anzeigen
        function filterRezepte() {
            console.log('Filtere Rezepte...');
            const verpflegungsart = document.getElementById('verpflegungsart').value;
            const verpflegungstyp = document.getElementById('verpflegungstyp').value;
            const nurVegetarisch = document.getElementById('vegetarisch').checked;

            const gefilterteRezepte = rezepteDaten.filter(rezept => {
                if (verpflegungsart && rezept.verpflegungsart !== verpflegungsart) return false;
                if (verpflegungstyp && rezept.verpflegungstyp !== verpflegungstyp) return false;
                if (nurVegetarisch && !rezept.vegetarisch) return false;
                return true;
            });

            // Rezepte Grid füllen
            const grid = document.getElementById('rezepte-grid');
            
            if (gefilterteRezepte.length === 0) {
                grid.innerHTML = '<div class="keine-rezepte">Keine Rezepte gefunden, die den Filterkriterien entsprechen.</div>';
                return;
            }

            grid.innerHTML = gefilterteRezepte.map(rezept => `
                <div class="rezept-karte" onclick="zeigeAusgewaehltesRezept(${rezept.id})">
                    <h4>${rezept.titel}</h4>
                    <div class="rezept-info">
                        <span>${rezept.kalorien} kcal/Person</span>
                        <span>${rezept.basisZeit} min (50 Pers.)</span>
                        <span>${rezept.vegetarisch ? 'Vegetarisch' : 'Mit Fleisch'}</span>
                    </div>
                    <p class="rezept-beschreibung">${rezept.beschreibung}</p>
                </div>
            `).join('');

            // Rezept Details ausblenden
            document.getElementById('rezept-details').style.display = 'none';
            aktuellesRezept = null;
        }

        // Ausgewähltes Rezept anzeigen
        function zeigeAusgewaehltesRezept(rezeptId) {
            const rezept = rezepteDaten.find(r => r.id === rezeptId);
            aktuellesRezept = rezept;

            if (!rezept) {
                console.error('Rezept nicht gefunden:', rezeptId);
                return;
            }

            // Skalierte Zeit berechnen
            const skalierteZeit = berechneZubereitungszeit(rezept.basisZeit, personenAnzahl);

            // Alle Rezept-Karten zurücksetzen
            document.querySelectorAll('.rezept-karte').forEach(karte => {
                karte.classList.remove('ausgewaehlt');
            });

            // Aktuelle Karte markieren
            document.querySelectorAll('.rezept-karte').forEach(karte => {
                if (karte.querySelector('h4').textContent === rezept.titel) {
                    karte.classList.add('ausgewaehlt');
                }
            });

            // Personenanzahl anzeigen
            document.getElementById('zutaten-personen').textContent = personenAnzahl;

            // Details anzeigen
            document.getElementById('rezept-titel').textContent = rezept.titel;
            document.getElementById('rezept-kalorien').textContent = `${rezept.kalorien * personenAnzahl} kcal gesamt`;
            document.getElementById('rezept-zubereitungszeit').textContent = `${skalierteZeit} min Zubereitung`;
            document.getElementById('rezept-art').textContent = `${rezept.verpflegungsart === 'warm' ? 'Warm' : 'Kalt'} • ${getVerpflegungstypText(rezept.verpflegungstyp)} • ${rezept.vegetarisch ? 'Vegetarisch' : 'Mit Fleisch'}`;

            // Zutaten anzeigen (skaliert mit Feldküchen-Umrechnung)
            const zutatenListe = document.getElementById('rezept-zutaten');
            zutatenListe.innerHTML = rezept.zutaten.map(zutat => {
                const skalierteMenge = (zutat.menge / 50) * personenAnzahl;
                const { menge, einheit } = konvertiereZuFeldkueche(skalierteMenge, zutat.einheit, zutat.name);
                
                return `<li>${menge} ${einheit} ${zutat.name}</li>`;
            }).join('');

            // Zubereitung anzeigen
            const zubereitungListe = document.getElementById('rezept-zubereitung');
            zubereitungListe.innerHTML = rezept.zubereitung.map(schritt => 
                `<li>${schritt}</li>`
            ).join('');

            // Portionierung anzeigen
            document.getElementById('rezept-portionierung').textContent = rezept.portionierung;

            // Details einblenden
            document.getElementById('rezept-details').style.display = 'block';
        }

        // Hilfsfunktion für Verpflegungstyp-Text
        function getVerpflegungstypText(typ) {
            switch(typ) {
                case 'voll': return 'Vollverpflegung';
                case 'lunch': return 'Lunchpakete';
                case 'hand': return 'Handverpflegung';
                default: return typ;
            }
        }

        // Zur Einkaufsliste navigieren
        function zurEinkaufsliste() {
            if (aktuellesRezept) {
                showPage('einkaufsliste');
            } else {
                alert('Bitte wähle zuerst ein Rezept aus!');
            }
        }

        // Einkaufsliste aktualisieren - OHNE GRUPPIERUNG
        function aktualisiereEinkaufsliste() {
            console.log('Aktualisiere Einkaufsliste für', personenAnzahl, 'Personen');
            
            // Personenanzahl in Einkaufsliste anzeigen
            document.getElementById('einkauf-personen').textContent = personenAnzahl;
            
            if (!aktuellesRezept) {
                document.getElementById('einkauf-rezept-titel').textContent = 'Kein Rezept ausgewählt';
                document.getElementById('einkaufsliste-content').innerHTML = '<p>Bitte wähle zuerst ein Rezept auf der Rezept-Seite aus.</p>';
                return;
            }

            document.getElementById('einkauf-rezept-titel').textContent = aktuellesRezept.titel;
            
            const container = document.getElementById('einkaufsliste-content');
            
            // Zutaten für Einkaufsliste OHNE Gruppierung
            if (aktuellesRezept.zutaten.length === 0) {
                container.innerHTML = '<p>Keine Zutaten gefunden.</p>';
                return;
            }
            
            // Einfache Liste ohne Kategorien + Getränke
            container.innerHTML = `
                <div class="einkaufsliste-container">
                    <h3>Alle Zutaten</h3>
                    ${aktuellesRezept.zutaten.map(zutat => {
                        const skalierteMenge = (zutat.menge / 50) * personenAnzahl;
                        const { menge, einheit } = konvertiereZuFeldkueche(skalierteMenge, zutat.einheit, zutat.name);
                        
                        return `
                            <div class="einkaufsliste-item">
                                <span>${zutat.name}</span>
                                <span>${menge} ${einheit}</span>
                            </div>
                        `;
                    }).join('')}
                    <!-- Getränke hinzufügen -->
                    <div class="einkaufsliste-item" style="background-color: #e8f4f8; margin-top: 10px; padding: 10px; border-radius: 4px;">
                        <span><strong>Getränke (Wasser, Saftschorle)</strong></span>
                        <span><strong>${personenAnzahl} l</strong></span>
                    </div>
                </div>
            `;
        }

        // Automatische Umrechnung für Feldküchen-Mengen - OHNE TL/EL
        function konvertiereZuFeldkueche(menge, einheit, zutatName) {
            const name = zutatName.toLowerCase();
            
            // Für große Mengen (ab 1000) in kg/l umrechnen
            if (einheit === "g" && menge >= 1000) {
                return { menge: (menge / 1000).toFixed(1), einheit: "kg" };
            }
            if (einheit === "ml" && menge >= 1000) {
                return { menge: (menge / 1000).toFixed(1), einheit: "l" };
            }
            
            // Für spezifische Zutaten automatisch passende Einheiten
            if (einheit === "" || einheit === "Stück") {
                if (name.includes('kartoffel') || name.includes('karotte') || name.includes('zwiebel') || 
                    name.includes('tomate') || name.includes('gurke') || name.includes('brokkoli') ||
                    name.includes('paprika') || name.includes('avocado') || name.includes('apfel') ||
                    name.includes('banane')) {
                    if (menge >= 10) {
                        return { menge: Math.round(menge), einheit: "kg" };
                    }
                }
            }
            
            // Standard: Einheit beibehalten, aber runden
            let angezeigteMenge = menge;
            if (menge % 1 !== 0) {
                angezeigteMenge = menge.toFixed(1);
            }
            
            // Für leere Einheiten "Stück" anzeigen
            const finaleEinheit = einheit === "" ? "Stück" : einheit;
            
            return { menge: angezeigteMenge, einheit: finaleEinheit };
        }

        // VERBESSERT: PDF Export für Rezept mit Tabelle - KOMPAKTE VERSION
        function exportRezeptPDF() {
            if (!aktuellesRezept) {
                alert('Bitte wähle zuerst ein Rezept aus!');
                return;
            }
        
            console.log('Starte PDF Export für:', aktuellesRezept.titel);
            
            // Skalierte Zeit für PDF berechnen
            const skalierteZeit = berechneZubereitungszeit(aktuellesRezept.basisZeit, personenAnzahl);
            
            const druckContainer = document.getElementById('druck-rezept-container');
            
            // Zutaten als Tabellenzeilen erstellen
            const zutatenTabelle = aktuellesRezept.zutaten.map(zutat => {
                const skalierteMenge = (zutat.menge / 50) * personenAnzahl;
                const { menge, einheit } = konvertiereZuFeldkueche(skalierteMenge, zutat.einheit, zutat.name);
                return `
                    <tr>
                        <td style="padding: 4px 6px; border-bottom: 1px solid #ddd; font-size: 10pt;">${zutat.name}</td>
                        <td style="padding: 4px 6px; border-bottom: 1px solid #ddd; text-align: right; font-weight: bold; font-size: 10pt;">${menge} ${einheit}</td>
                    </tr>
                `;
            }).join('');
        
            // Zubereitung als nummerierte Liste
            const zubereitungListe = aktuellesRezept.zubereitung.map((schritt, index) => 
                `<li style="margin-bottom: 6px; line-height: 1.3; font-size: 10pt;">${schritt}</li>`
            ).join('');
        
            // KOMPAKTE Druck-Container füllen
            druckContainer.innerHTML = `
                <div class="druck-rezept" style="font-family: Arial, sans-serif; max-width: 700px; margin: 0 auto; padding: 15px; font-size: 10pt;">
                    <!-- Kopfbereich -->
                    <div style="border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 15px;">
                        <h1 style="color: #2c3e50; font-size: 16pt; margin-bottom: 8px; text-align: center;">${aktuellesRezept.titel}</h1>
                        <div style="display: flex; justify-content: center; gap: 15px; font-size: 9pt; color: #666; flex-wrap: wrap;">
                            <span><strong>${aktuellesRezept.kalorien * personenAnzahl} kcal</strong> gesamt</span>
                            <span><strong>${skalierteZeit} min</strong> Zubereitung</span>
                            <span>${aktuellesRezept.verpflegungsart === 'warm' ? 'Warm' : 'Kalt'} • ${getVerpflegungstypText(aktuellesRezept.verpflegungstyp)} • ${aktuellesRezept.vegetarisch ? 'Vegetarisch' : 'Mit Fleisch'}</span>
                        </div>
                    </div>
                    
                    <!-- Zutaten Tabelle -->
                    <div style="margin-bottom: 20px;">
                        <h2 style="color: #2c3e50; font-size: 12pt; border-bottom: 1px solid #3498db; padding-bottom: 5px; margin-bottom: 10px;">
                            Zutaten für ${personenAnzahl} Personen
                        </h2>
                        <table style="width: 100%; border-collapse: collapse; font-size: 9pt;">
                            <thead>
                                <tr>
                                    <th style="padding: 6px 8px; border-bottom: 1px solid #3498db; text-align: left; background: #f8f9fa;">Zutat</th>
                                    <th style="padding: 6px 8px; border-bottom: 1px solid #3498db; text-align: right; background: #f8f9fa;">Menge</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${zutatenTabelle}
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Zubereitung als nummerierte Liste -->
                    <div style="margin-bottom: 20px;">
                        <h2 style="color: #2c3e50; font-size: 12pt; border-bottom: 1px solid #3498db; padding-bottom: 5px; margin-bottom: 10px;">
                            Zubereitung
                        </h2>
                        <ol style="padding-left: 15px; font-size: 10pt; line-height: 1.3;">
                            ${zubereitungListe}
                        </ol>
                    </div>
                    
                    <!-- Portionierung & Getränke -->
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 3px; margin-top: 15px; border-left: 3px solid #3498db;">
                        <h3 style="color: #2c3e50; font-size: 11pt; margin-bottom: 5px;">Portionierung & Getränke</h3>
                        <p style="line-height: 1.3; margin: 0; font-size: 9pt;">${aktuellesRezept.portionierung}</p>
                        <p style="line-height: 1.3; margin: 10px 0 0 0; font-size: 9pt; font-weight: bold;">Getränke: ${personenAnzahl} Liter (Wasser, Saftschorle) - 1 Liter pro Person</p>
                    </div>
        
                    <!-- Footer -->
                    <div style="margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; font-size: 8pt; color: #666; text-align: center;">
                        <p>Erstellt am: ${new Date().toLocaleString('de-DE')} | Quelle: SEG Feldküche - Katastrophenschutz</p>
                    </div>
                </div>
            `;
        
            // Container für Druck sichtbar machen
            druckContainer.style.display = 'block';
            
            console.log('Druck-Container gefüllt, starte Druck...');
            
            // Kurz warten dann drucken
            setTimeout(() => {
                window.print();
                
                // Nach Druck wieder ausblenden
                setTimeout(() => {
                    druckContainer.style.display = 'none';
                    druckContainer.innerHTML = '';
                    console.log('Druck abgeschlossen, Container geleert');
                }, 500);
            }, 100);
        }
        
        // PDF Export für Einkaufsliste - OHNE GRUPPIERUNG
        function exportEinkaufslistePDF() {
            if (!aktuellesRezept) {
                alert('Bitte wähle zuerst ein Rezept aus!');
                return;
            }
        
            const druckContainer = document.getElementById('druck-einkaufsliste-container');
            
            druckContainer.innerHTML = `
                <div style="font-family: Arial, sans-serif; max-width: 700px; margin: 0 auto; padding: 15px; font-size: 10pt;">
                    <div style="text-align: center; margin-bottom: 15px;">
                        <h2 style="font-size: 16pt; margin-bottom: 5px;">Einkaufsliste</h2>
                        <p style="font-size: 10pt;"><strong>${aktuellesRezept.titel}</strong> für ${personenAnzahl} Personen</p>
                    </div>
                    
                    <div style="background: white; padding: 15px; margin-bottom: 12px; border-radius: 3px; border: 1px solid #eee;">
                        <h3 style="color: #2c3e50; font-size: 12pt; margin-bottom: 10px; border-bottom: 1px solid #ecf0f1; padding-bottom: 3px;">Alle Zutaten</h3>
                        ${aktuellesRezept.zutaten.map(zutat => {
                            const skalierteMenge = (zutat.menge / 50) * personenAnzahl;
                            const { menge, einheit } = konvertiereZuFeldkueche(skalierteMenge, zutat.einheit, zutat.name);
                            
                            return `
                                <div style="display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #f5f5f5; font-size: 10pt;">
                                    <span>${zutat.name}</span>
                                    <span style="color: #3498db; font-weight: bold;">${menge} ${einheit}</span>
                                </div>
                            `;
                        }).join('')}
                        <!-- Getränke hinzufügen -->
                        <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f5f5f5; font-size: 10pt; background: #e8f4f8; margin-top: 10px; padding: 10px; border-radius: 4px;">
                            <span style="font-weight: bold;">Getränke (Wasser, Saftschorle)</span>
                            <span style="color: #3498db; font-weight: bold;">${personenAnzahl} l</span>
                        </div>
                    </div>

                    <div style="margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; font-size: 8pt; color: #666; text-align: center;">
                        <p>Erstellt am: ${new Date().toLocaleString('de-DE')} | Quelle: SEG Feldküche - Katastrophenschutz</p>
                    </div>
                </div>
            `;
        
            // Container für Druck sichtbar machen
            druckContainer.style.display = 'block';
            
            // Kurz warten dann drucken
            setTimeout(() => {
                window.print();
                
                // Nach Druck wieder ausblenden
                setTimeout(() => {
                    druckContainer.style.display = 'none';
                    druckContainer.innerHTML = '';
                }, 500);
            }, 100);
        }
    </script>
</body>
</html>
